services:
  # Vault Service
  vault:
    hostname: vault
    container_name: vault
    image: {{registry_url}}/vault:1.12.0
    environment:
      VAULT_ADDR: "https://{{vault_ip}}:8200"
      VAULT_API_ADDR: "https://{{vault_ip}}:8200"
    ports:
      - "8200:8200"
    volumes:
      - /data/vault/config:/vault/config:rw  # Vault configuration file
      - /data/vault/file:/vault/file:rw      # Persistent storage (if using file backend)
      - /data/vault/logs:/vault/logs:rw      # Logs directory
      - /data/vault/certs:/vault/config/certs:ro
    cap_add:
      - IPC_LOCK
    entrypoint: >
      vault server
      -config=/vault/config/vault.hcl
    restart: always
volumes:
  vault_data:
    driver: local
 
